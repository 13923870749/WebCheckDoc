# 中文文档自动审核系统 详细需求分析

## 一、项目背景与目标

### 1.1 背景
- 技术文档（如检测方案、报告）数量激增，人工审核效率低、易遗漏、标准不统一。
- 需开发本地部署、面向中文文档的自动审核系统，提升效率与质量，支持自定义审核规则。

### 1.2 总体目标
- 支持本地部署，保障数据安全。
- 支持PDF、Word、Markdown、TXT等主流格式，自动转为Markdown。
- 审核结合大模型与自定义规则，结果以Markdown形式展示。
- 简单易用，适合非技术用户，支持敏捷开发与快速迭代。

---

## 二、用户与权限体系

### 2.1 角色定义
- **超级管理员**：系统最高权限，管理所有用户与配置。
- **管理员**：管理用户、公开知识库、系统日志。
- **普通用户**：使用公开知识库、提交审核任务、查看个人结果。

### 2.2 权限矩阵

| 功能模块         | 超级管理员 | 管理员 | 普通用户 |
|------------------|:----------:|:------:|:--------:|
| 用户管理         |     ✓      |   ✓    |    ✗     |
| 系统配置         |     ✓      |   ✗    |    ✗     |
| 公开知识库管理   |     ✓      |   ✓    |    ✗     |
| 个人知识库管理   |     ✓      |   ✓    |    ✓     |
| 审核任务创建     |     ✓      |   ✓    |    ✓     |
| 审核结果查看     |     ✓      |   ✓    | 仅个人   |
| 系统日志查看     |     ✓      |   ✓    |    ✗     |

### 2.3 用户管理功能
- 注册、登录、登出、个人信息管理
- 密码重置、邮箱验证、启用/禁用、操作日志

---

### 3.1 知识库管理

1. 文档管理
   - 多格式上传与批量上传：支持单个/批量上传PDF、Word（.doc/.docx）、Markdown（.md）、TXT文件，自动检测类型与大小，支持拖拽上传、进度显示、失败重试。
   - 自动格式转换与内容提取：上传后自动统一转换为Markdown，扫描版PDF自动OCR识别，自动提取表格、图片，保留原有结构。
   - 文档结构与元数据分析：自动识别标题、章节、段落、目录，自动提取元数据（标题、作者、时间、来源等），支持手动补充/编辑。
   - 文档的增删改查与归档：支持新增、重命名、编辑、删除、恢复，支持归档、彻底删除，支持列表分页、排序、筛选、模糊搜索。

2. 知识片段管理与标签分类
   - 自动切分与片段管理：文档上传后自动按段落/章节/空行切分为知识片段，支持新增、编辑、删除、合并、拆分、批量操作。
   - 标签与元数据管理：支持为片段添加/移除标签，标签可自定义、自动补全，支持片段元数据管理（来源、作者、时间、引用等），支持标签的增删改查、分组、颜色。
   - 片段间关联与检索：支持片段间建立引用、上下游、相似关系，支持全文检索、标签检索、语义检索，检索结果高亮、筛选、排序。
   - 片段归档与恢复：支持片段归档、恢复归档、彻底删除，支持历史记录与操作日志。

3. 权限、协作与版本管理
   - 权限分级：支持知识库/文档/片段的公开、私有、协作三种权限，协作成员可分配只读/可编辑权限，支持权限变更日志。
   - 协作编辑：支持多人协作编辑同一知识库/文档/片段，支持协作邀请、成员管理、协作通知，支持冲突检测与合并。
   - 版本管理：支持文档和片段的版本自动保存、手动快照，支持历史浏览、对比、回滚，支持变更说明、版本标签。
   - 操作日志：记录所有增删改查、权限变更、协作操作日志，支持日志检索、导出。

4. 导入导出、编辑与预览
   - 导入导出：支持知识库/文档/片段的导入导出（Markdown、Word、PDF、JSON等格式），支持批量导入导出，导出可选带标签、元数据。
   - 在线编辑与实时保存：提供在线Markdown编辑器，支持实时编辑、自动保存、撤销重做，支持富文本/代码/表格/图片等内容编辑，支持编辑历史记录与恢复。
   - 预览与打印：支持文档和片段的Markdown实时预览，支持打印预览、直接打印、导出为PDF，预览时高亮标签、元数据、引用关系。
   - 批量操作：支持文档和片段的批量标签、批量归档、批量导出等操作。

### 3.2 审核功能

1. 审核要求管理
   - 预设审核模板：提供常用审核模板（如格式规范、逻辑一致性、术语规范、错别字检查等），可一键应用，支持内容预览和说明。
   - 用户自定义审核规则：支持自定义正则、关键词、逻辑规则等，支持命名、描述、保存、编辑、删除，支持启用/禁用切换。
   - 审核要求组合：支持多条审核规则组合成审核方案，支持方案保存、编辑、删除、版本管理与回滚。
   - 审核要求分级：支持“强制”、“建议”等分级，结果可按级别展示。

2. 审核任务管理与大模型集成
   - 审核任务创建：支持单个/批量上传待审核文档，选择参照文档，选择审核方案（模板/自定义组合）。
   - 审核任务调度与状态管理：支持任务优先级设置，状态跟踪（待审核、审核中、已完成、失败），任务暂停、恢复、取消，进度实时显示。
   - 大模型集成：支持本地大模型与云端API切换，多模型并行处理，模型参数配置，调用日志与错误追踪。

3. 审核内容
   - 文字与格式检查：错别字、标点符号、格式错误（标题、段落、表格、图片等）。
   - 逻辑一致性检查：前后文逻辑关系、数据一致性、引用一致性。
   - 术语规范性检查：专业术语使用、术语统一性、术语表对照。
   - 内容完整性检查：必要章节、关键信息完整性、缺失内容提示。
   - 审核内容可扩展：支持后续增加如敏感词检测、重复率检测等新审核项。

4. 审核结果展示
   - 结果展示方式：以Markdown格式展示，支持错误高亮、批注、建议等标注，分级展示（错误、警告、建议）。
   - 结果筛选与排序：支持按类型、级别、位置等筛选，按严重程度、出现频率等排序。
   - 结果导出：支持导出为PDF、Word、Markdown等格式，支持带批注、高亮版本。
   - 审核结果反馈：支持用户反馈（如“误报”、“已修正”等），反馈结果可用于优化审核规则/模型。

### 3.3 系统管理与部署

1. 部署方案与系统配置
   - 支持Docker Compose一键部署、脚本部署
   - 支持Linux/Windows/macOS多平台，支持本地和云端部署
   - 提供详细部署文档和平台兼容性说明
   - 系统配置支持Web界面和配置文件双模式，支持参数热更新

2. 性能监控与日志管理
   - 支持系统性能监控（CPU、内存、磁盘、网络）、任务队列监控、用户活跃度统计
   - 日志管理包括操作日志、系统日志、错误日志、审计日志
   - 支持日志检索、导出、异常告警

3. 数据管理与安全管理
   - 支持数据备份、恢复、导入导出、清理归档、加密存储
   - 安全管理包括访问控制、权限分级、HTTPS、数据隔离、用户操作审计、异常告警

4. 界面与多平台兼容
   - 提供响应式Web管理界面，支持深色/浅色主题切换
   - 适配PC端主流浏览器
   - 支持多平台（Windows、Linux、macOS）运行

---

## 五、技术架构与选型

1. 前端架构
   - 采用 Vue3 或 React + TypeScript + Ant Design
   - 支持单页应用（SPA）、响应式布局、组件化开发
   - 实现与后端的 RESTful API 对接，支持权限控制、国际化、主题切换

2. 后端架构
   - 采用 Python（FastAPI）或 Java（Spring Boot）
   - RESTful API 设计，分层架构（路由、服务、数据访问、模型）
   - 支持异步任务处理（如 Celery、FastAPI BackgroundTasks）
   - 集成权限中间件、认证、日志、异常处理

3. 模型服务
   - 支持本地大模型（DeepSeek、ChatGLM等）与云端API（OpenAI、文心一言等）灵活切换
   - 支持多模型并行、参数配置、模型调用日志
   - 支持模型服务的容器化部署与扩展

4. 数据库与缓存
   - 结构化数据采用 MySQL，支持主从、分区、备份
   - Redis 用于缓存、任务队列、会话管理

5. 文档处理与向量数据库
   - 文档解析采用 Apache Tika、Pandoc，支持多格式自动转换
   - 向量数据库采用 Chroma、FAISS 或 Milvus，支持知识片段 embedding、语义检索

6. 部署与运维
   - 统一采用 Docker Compose 部署，支持一键启动、扩容
   - 支持 CI/CD 自动化部署，支持多环境（开发/测试/生产）配置
   - 提供系统监控、日志、备份、告警等运维工具

---

## 六、数据模型（主要表结构与关系）

1. 用户表（user）
   - id, 用户名, 密码哈希, 邮箱, 角色（超级管理员/管理员/普通用户）, 状态, 创建/更新时间, 最近登录时间等

2. 知识库表（knowledge_base）
   - id, 名称, 类型（公开/个人/协作）, 所有者, 描述, 权限设置, 创建/更新时间

3. 文档表（document）
   - id, 知识库id, 标题, 原始文件名, 文件类型, 大小, 状态, 版本号, 元数据（作者、来源、时间等）, 创建/更新时间

4. 知识片段表（fragment）
   - id, 文档id, 内容, 片段类型（正文/表格/图片等）, 标签, 元数据, 关联片段id, 创建/更新时间

5. 向量索引表（vector_index）
   - id, 片段id, 向量数据, embedding模型类型, 维度, 创建/更新时间

6. 审核任务表（review_task）
   - id, 创建者, 关联文档/片段id, 审核要求/模板, 状态（待审核/审核中/已完成/失败）, 优先级, 进度, 创建/更新时间

7. 审核结果表（review_result）
   - id, 任务id, 结果内容（Markdown/结构化JSON）, 错误/警告/建议分级, 批注, 反馈状态, 导出记录, 创建/更新时间

- 各表之间通过外键关联，支持多对多（如片段与标签、文档与知识库）、一对多（如知识库与文档、文档与片段）等关系
- 支持历史版本、操作日志、权限字段等扩展

---

## 七、MVP阶段建议（细化）

1. 核心目标
   - 快速实现可用的最小功能集，支撑文档自动审核的基本闭环
   - 降低部署和使用门槛，便于后续迭代和用户反馈

2. 功能范围
   - 用户注册、登录、登出、基础权限管理（超级管理员/普通用户）
   - 文档上传（PDF/Word/Markdown/TXT）、自动格式转换为Markdown
   - 知识库基础管理（增删改查、个人/公开库）
   - 简单审核功能（错别字、格式检查等基础项）
   - 审核任务创建、进度反馈、结果展示（Markdown高亮、分级）、结果导出（PDF/Word/Markdown）
   - Docker一键部署，支持本地大模型集成
   - 基础操作日志、异常提示、表单校验、权限校验

3. 技术实现
   - 前端：Vue3/React + TypeScript + Ant Design，SPA架构
   - 后端：FastAPI/Java Spring Boot，RESTful API
   - 数据库：MySQL，缓存：Redis
   - 文档处理：Pandoc/Tika，基础大模型：DeepSeek/ChatGLM
   - 部署：Docker Compose，提供详细部署文档

4. MVP验收标准
   - 系统可正常启动、注册/登录/登出
   - 支持文档上传、格式转换、知识库管理
   - 审核任务可创建、执行、查看结果、导出报告
   - 权限控制、表单校验、异常提示完善
   - 用户界面简洁、操作流畅

---

## 八、典型用户流程（细化）

### 管理员流程
1. 系统初始化与配置
   - 通过Docker一键部署系统，完成初始化配置
   - 创建/管理用户账号，分配角色权限
2. 知识库管理
   - 创建公开知识库，上传标准文档
   - 管理知识库文档（增删改查、归档、标签）
3. 审核模板与规则管理
   - 配置审核模板、基础审核规则
4. 系统监控与日志
   - 查看系统运行状态、操作日志、异常告警
5. 审核任务管理
   - 查看所有用户的审核任务与结果，导出统计报告

### 普通用户流程
1. 注册与登录
   - 用户注册账号，邮箱验证，登录系统
2. 个人知识库管理
   - 创建/管理个人知识库，上传文档（PDF/Word/Markdown/TXT）
   - 文档自动格式转换，支持批量上传
3. 审核任务创建
   - 选择文档，选择审核模板，提交审核任务
   - 实时查看审核进度，支持任务取消/重试
4. 审核结果查看与导出
   - 查看审核结果（高亮、分级、批注）
   - 导出审核报告（PDF/Word/Markdown）
5. 个人信息与权限
   - 修改个人信息、密码，查看操作日志
   - 遇到权限不足时获得友好提示

### 交互细节
- 所有表单均有前端/后端双重校验，错误信息友好提示
- 审核任务有进度条、状态反馈
- 审核结果支持筛选、排序、分级展示
- 导出报告可选格式，导出过程有进度提示
- 权限不足、操作失败等场景有明确提示

---

## 九、知识增强与RAG支持（进阶）

1. 知识片段化
   - 文档上传后自动按段落/章节/空行切分为知识片段
   - 支持片段的增删改查、编辑、标签、元数据管理
   - 支持片段间的引用、上下游、相似关系
   - 支持片段的版本管理、引用统计、历史记录

2. 检索增强
   - 支持关键词、标签、全文检索
   - 支持语义检索（embedding/向量检索）、多模态检索（文本、表格、图片）
   - 检索结果高亮、相关性排序、智能推荐相关片段

3. 审核增强（RAG流程）
   - 审核任务创建时可选/推荐相关知识片段
   - 将知识片段、审核要求、待审核文档一同传递给大模型
   - 审核报告中标注引用片段内容及来源，便于溯源
   - 支持审核结果的知识反馈，持续优化知识库

4. 高级功能扩展
   - 支持知识片段embedding生成与向量库检索
   - 支持知识图谱构建与可视化
   - 支持片段引用统计、版本管理
   - 支持人工标注与机器学习优化
   - 支持多语言知识库管理

---

## 十、风险与持续改进

- 技术/业务/安全风险及缓解措施
- 敏捷开发，分阶段迭代，用户反馈驱动持续优化

--- 